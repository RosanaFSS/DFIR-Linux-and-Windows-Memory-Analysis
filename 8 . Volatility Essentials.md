<h1 align="center">Volatility Essentials<br><img width="1200px" src="https://github.com/user-attachments/assets/3c611801-4d91-40e8-b35b-a2395cf04ada"></h1>

<p align="center"><img width="80px" src="https://github.com/user-attachments/assets/b3c3953c-b8ca-431d-a83f-83d1adc6dd99"><br>
June 17, 2025<br> Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>,<br>
and I’m excited to join you on this adventure,<br>
part of my <code>407</code>-day-streak in<a href="https://tryhackme.com">TryHackMe</a>.<br>
Learn how to perform memory forensics with Volatility!. Click <a href="https://tryhackme.com/room/volatilityessentials"</a>here to acces this walkthrough.<br>
<img width="1200px" src=""></p>

<h2> Task 1 . Introduction</h2>

<h3>Set up your virtual environment</h3>
<p>To successfully complete this room, you'll need to set up your virtual environment. This involves starting the Task Machine, ensuring you're equipped with the necessary tools and access to tackle the challenges ahead.</p>

<p>[  Target machine  ]</p>

<p>In the previous room, Memory Analysis Introduction, we learnt about the vital nature of memory forensics in cyber security. We explored the structure of memory dumps, differentiated between RAM and disk forensics, and saw scenarios where memory analysis is essential.<br><br>

Here, we shall begin looking at the practical aspects of memory forensics through tools, specifically Volatility.</p>

<h3>Learning Objectives</h3>
<p>

- Getting familiar with the Volatility Framework<br>
- Navigate and utilise basic Volatility commands and plugins<br>
- Conduct forensic analysis to identify key artefacts such as running processes and loaded DLLs using Volatility.</p>

<h3>Prerequisites</h3>

<p>

- <a href="https://tryhackme.com/room/memoryanalysisintroduction">Memory Analysis Introduction</a><br>
- <a href="https://tryhackme.com/room/btwindowsinternals">Core Windows Processes</a></p>

<h3 align="left"> Answer the question below</h3>

> 1.1. <em>Ready to learn about Volatility and memory analysis.</em><br><a id='1.1'></a>
>> <strong><code>No answer needed</code></strong><br>
<p></p>

<br>

<h2>Task 2 . Volatility Overview</h2>

<p><a href="https://volatilityfoundation.org/the-volatility-framework/">Volatility</a> is an open-source memory forensics framework that is cross-platform, modular, and extensible. The framework has undergone various iterations over the years, with the current version being Volatility 3. This version is superior to its predecessors as it abandoned static OS profiling in favour of dynamic symbol resolution, supporting newer operating systems, memory layouts, and complete insight into the runtime state of the system.</p>

<h3>Architectural Overview</h3>

<p>Volatility 3 is made up of several key layers:<br>

- <code>Memory layers</code>: These layers represent the hierarchy of address spaces, from raw memory to virtual address translations.<br>
- <code>Symbol tables</code>: The tables enable kernel and process structures to be interpreted through OS-specific debugging symbols.<br>
- <code>Plugins</code>: These are modular routines that leverage the underlying memory layers and symbol tables to extract artefacts of forensic interest. Later in the room, we shall look at some key plugins used.</p>

<h3>System Requirements and Installation</h3>

<p>Volatility 3 requires Python 3.6 or later to run. Additionally, it benefits from various libraries such as <code>pefile</code>, <code>capstone</code>, and <code>yata-python</code> that allow us to process portable executables, perform memory disassembly, and use YARA rules in our analysis, respectively. The terminal output below shows how to install Volatility by cloning the <a href="https://github.com/volatilityfoundation/volatility3.git">GitHub Repository</a> and running it directly from the source.<br><br>

Volatility has already been installed on the machine attached to this room and can be accessed under the <code>Desktop/volatility3</code> directory.</p>

<p><em>Volatility Installation</em></p>

```bash
ubuntu@tryhackme:~/Desktop$ git clone https://github.com/volatilityfoundation/volatility3.git
ubuntu@tryhackme:~/Desktop$ cd volatility3
ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py -h
Volatility 3 Framework 2.26.2
usage: vol.py [-h] [-c CONFIG] [--parallelism [{processes,threads,off}]] [-e EXTEND] [-p PLUGIN_DIRS] [-s SYMBOL_DIRS] [-v] [-l LOG] [-o OUTPUT_DIR] [-q]
              [-r RENDERER] [-f FILE] [--write-config] [--save-config SAVE_CONFIG] [--clear-cache] [--cache-path CACHE_PATH] [--offline | -u URL]
              [--filters FILTERS] [--hide-columns [HIDE_COLUMNS ...]] [--single-location SINGLE_LOCATION] [--stackers [STACKERS ...]]
              [--single-swap-locations [SINGLE_SWAP_LOCATIONS ...]]
              PLUGIN ...

An open-source memory forensics framework

options:
  -h, --help            Show this help message and exit, for specific plugin options use 'vol.py  --help'
  -c CONFIG, --config CONFIG
                        Load the configuration from a json file
------TRUNCATED--------
```

<h3 align="left"> Answer the question below</h3>

> 2.1. <em>Read the above and navigate to the Volatility directory.</em><br><a id='2.1'></a>
>> <strong><code>No answer needed</code></strong><br>
<p></p>

<br>

<h2>Task 3 . Memory Acquisition and Analysis</h2>

<h3>Memory Acquisition Methodologies</h3>

<p>Memory acquisition is a foundational step in forensics that must be performed in a manner that ensures we maintain the integrity of evidence. The process and the deployment environment used vary from one OS to another.</p>

<br>

<p>For Windows systems, the following tools can be used to conduct memory acquisition:<br>

- <code>DumpIt</code>: captures a full physical memory image on 32/64‑bit Windows and automatically hashes the output.<br>
- <code>WinPmem</code>: Open‑source driver‑based tool that acquires RAM in RAW/ELF formats and embeds acquisition metadata for chain‑of‑custody.<br>
- <code>Magnet RAM Capture</code>: GUI‑driven collector that snapshots volatile memory on live Windows hosts while minimising footprint.<br>
- <code>FTK Imager</code>: The most common commercial tool that acquires memory and selected logical artefacts alongside disk imaging functions. </p>

<br>

<p>For Linux and macOS systems,  we can employ the services of the following tools:<br>

- <code>AVML</code>: Lightweight Microsoft CLI utility that dumps Linux memory to a compressed ELF file without requiring a kernel module.<br>
- <code>LiME</code>: Loadable Kernel Module for Linux that captures full volatile memory over disk or network and supports ARM/x86 architectures.<br>
- <code>OSXPmem</code>: macOS‑specific fork of Pmem that creates raw memory images on Intel‑based Macs for subsequent Volatility analysis.</p>

<h5 align="center"><img width="600px" src="https://github.com/user-attachments/assets/5aa0c2b1-b716-45aa-9f64-e6d6898a7187"><br>This image and all the theoretical content of the present article is TryHackMe´s property.</h5>

<br>

<p>Extracting memory from virtual environments can be done by collecting the virtual memory file from the host machine's drive. Depending on the hypervisor in use, the output file will likely differ, and you would likely encounter the following examples:<br>

- VMware - <code>.vmem</code><br>
- Hyper-V - <code>.bin</code><br>
- Parallels - <code>.mem</code><br>
- VirtualBox - <code>.sav</code> It is worth noting that this is a partial memory file. </p>

<h3>Memory Analysis</h3>
<p>To have a holistic and hands-on understanding of Volatility, we shall investigate a forensic case and use it to learn about the tool's inner workings. The files for the analysis are found under the <code>Desktop/Investigations</code>code> directory.</p>

<h4>Case 001</h4>
<p>Your SOC has informed you that they have gathered a memory dump from a quarantined endpoint thought to have been compromised by a banking trojan masquerading as an Adobe document. Your job is to use your knowledge of threat intelligence and reverse engineering to perform memory forensics on the infected host.<br><br>

You have been informed of a suspicious IP in connection with the file that could be helpful:  <code>41.168.5.140</code>.</p>

<h4>Plugins</h4>
<p>Volatility uses plugins to request data to carry out analysis. Some of the most commonly used plugins include:<br>

- <code>windows.info</code><br>
- <code>linux.info</code><br>
- <code>pslist</code><br>
- <code>.pstree</code> </p>

<p>Let us look at these plugins, extracting information from our memory file. First, we can begin by obtaining operating system details from the image. In previous versions of Volatility, this information was identified as OS profiles and was extracted using the plugin <code>imageinfo</code>. However, OS profiles have been deprecated in the new version, and now we have the individual information plugins.<br><br>

Given that our memory file was obtained from a Windows VM running on VMware, we can extract details about its profile with the command below:</p>


<p><em>Volatility Windows Info</em></p>

```bash
ubuntu@tryhackme:~/Desktop/volatility3$ python3 vol.py -f ~/Desktop/Investigations/Investigation-1.vmem windows.info
Volatility 3 Framework 2.26.2
WARNING  volatility3.framework.layers.vmware: No metadata file found alongside VMEM file. A VMSS or VMSN file may be required to correctly process a VMEM file. These should be placed in the same directory with the same file name, e.g. Investigation-1.vmem and Investigation-1.vmss.
Progress:  100.00               PDB scanning finished                                                                                              
Variable        Value

Kernel Base     0x804d7000
DTB     0x2fe000
Symbols file:///home/ubuntu/Desktop/volatility3/volatility3/symbols/windows/ntkrnlpa.pdb/30B5FB31AE7E4ACAABA750AA241FF331-1.json.xz
```

<p>We can extract the system version, architecture, symbol tables, and available memory layers from the details.</p>


<h3 align="left"> Answer the questions below</h3>

> 3.1. <em>What is the build version of the host machine in Case 001?</em> Hint : <em>Utilise the windows.info plugin to uncover information.</em><br><a id='3.1'></a>
>> <strong><code>_____</code></strong><br>
<p></p>

<br>

> 3.2. <em>At what time was the memory file acquired in Case 001?</em> Hint: <em>Utilise the windows.info plugin to uncover information.</em><br><a id='3.2'></a>
>> <strong><code>_____</code></strong><br>
<p></p>

<br>
